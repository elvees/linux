# SPDX-License-Identifier: GPL-2.0+
%YAML 1.2
---
$id: http://devicetree.org/schemas/spi/silvaco-qspi.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Silvaco QSPI controller

maintainers:
  - Omar Al-Wadi <oalwadi@elvees.com>

properties:
  compatible:
    oneOf:
      - items:
          - enum:
              - elvees,mcom03-hsperiph-qspi   # MCom-03 HSPERIPH URB support
              - elvees,mcom03-service-qspi    # MCom-03 SERVICE URB support
          - const: silvaco,axi-qspi

      - items:
          - const: silvaco,axi-qspi           # generic Silvaco QSPI controller

  reg:
    maxItems: 1

  '#address-cells':
    const: 1

  '#size-cells':
    const: 0

  clock-names:
    items:
      - const: clk_axi
      - const: clk_ext

  clocks:
    items:
      - description: Controller operating clock
      - description: Interface operating clock

  num-cs:
    minimum: 1
    maximum: 8

  elvees,urb:
    $ref: /schemas/types.yaml#/definitions/phandle
    description:
      A phandle to the syscon node describing URB registers.

  silvaco,qspi-mode:
    description: 0 - normal mode; 1 - XIP mode
    $ref: /schemas/types.yaml#/definitions/uint32
    enum:
      - 0
      - 1
    default: 0

# Slave schema can be found in file spi-controller.yaml in the same directory

additionalProperties: false

required:
  - compatible
  - '#address-cells'
  - '#size-cells'
  - reg
  - clocks
  - clock-names

examples:
  - |
    #include <dt-bindings/clock/mcom03-clock.h>

    qspi0: spi@1ff00000 {
      status = "disabled";
      compatible = "elvees,mcom03-hsperiph-qspi", "silvaco,axi-qspi";
      #address-cells = <1>;
      #size-cells = <0>;
      silvaco,qspi-mode = <0>;
      reg = <0x1ff00000 0x10000>;
      clock-names = "clk_axi", "clk_ext";
      clocks = <&service_ucg1 CLK_SERVICE_UCG0_QSPI0>,
              <&service_ucg1 CLK_SERVICE_UCG0_QSPI0_EXT>;
      num-cs = <4>;
    };
